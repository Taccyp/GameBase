<% javascript_include_tag 'search' %>
<p> hello <%= current_user.email unless current_user.nil? %> </p>
<% if @search == [] %>
<h1> Looks like nothing in the database matched your search ... :( </h1>
<%end%>

<div class="search_results_container">
	<% @search.each do |result| %>
	<img src='<%= result["image"]["icon_url"] unless result["image"].nil? %>' >
	<% if !result["original_release_date"].nil? %>
	<p><%=Date.parse(result["original_release_date"]).year %></p>
	<%end%>
	<h2> <%= result["name"] %> </h2>
	<p> <%= result["deck"] %> </p>
		<% if !result["platforms"].nil? %>
	 		<span id="platform_list"> Platforms:<% result["platforms"].each do |platform| %>
	 			<%= platform["name"] %> 
	 		</span>
	 	<%end%>

	 <%end%>

	<% if  !current_user.nil? and Game.where(user_id: current_user.id).exists?(:game_id => result["id"]) %>
	<p id="in_collection_notice"> In your collection </p>
	
	<%else%>
		<%= form_for Game.new, remote: true do |f| %>
		<%= f.hidden_field :game_id, :value => result["id"] %>
		<%= f.hidden_field :game_name, :value => result["name"] %>
		<%= f.hidden_field :platforms, :value => result["platforms"] %>
		<%= f.hidden_field :img_url, :value => result["image"]["icon_url"] unless result["image"].nil?  %>
		<%= submit_tag "Add to Collection", :class => 'btn btn-success', :id=> result["id"] %>
			<%end%>
		<%end%>
	<%end%>
</div>